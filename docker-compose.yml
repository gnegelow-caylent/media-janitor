version: "3.8"

services:
  media-janitor:
    build: .
    image: media-janitor:latest
    container_name: media-janitor
    restart: unless-stopped
    ports:
      - "9000:9000"
    volumes:
      # Configuration file
      - ./config.yaml:/data/config.yaml:ro
      # Logs and persistent state
      - ./logs:/data/logs
      - ./state:/data/state

      # ============================================================
      # Mount NAS paths - these are the ACTUAL filesystem paths
      # Path mappings in config.yaml translate Radarr/Sonarr paths
      # ============================================================
      # NAS 1 (192.168.1.2) - TV/Sonarr
      - /mnt/remotes/192.168.1.2_video:/mnt/remotes/192.168.1.2_video:ro
      # NAS 2 (192.168.1.5) - Movies/Radarr
      - /mnt/remotes/192.168.1.5_video:/mnt/remotes/192.168.1.5_video:ro

    environment:
      - TZ=America/New_York  # Adjust to your timezone
    # Optional: limit CPU for background scanning
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
    networks:
      - media-network

networks:
  media-network:
    external: true  # Use existing network with Radarr/Sonarr
    # Or create a new one:
    # driver: bridge
