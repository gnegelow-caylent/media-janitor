version: "3.8"

services:
  media-janitor:
    build: .
    image: media-janitor:latest
    container_name: media-janitor
    restart: unless-stopped
    ports:
      - "9000:9000"
    labels:
      # Unraid WebUI button
      net.unraid.docker.webui: "http://[IP]:[PORT:9000]/"
      net.unraid.docker.icon: "https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/radarr-logo.png"
    volumes:
      # Configuration file
      - ./config.yaml:/data/config.yaml:ro
      # Logs and persistent state
      - ./logs:/data/logs
      - ./state:/data/state

      # NAS mounts - path mappings in config.yaml translate Radarr/Sonarr paths
      # NAS 1 (192.168.1.2) - Sonarr TV
      - /mnt/remotes/192.168.1.2_video:/mnt/remotes/192.168.1.2_video:ro
      # NAS 2 (192.168.1.5) - Radarr Movies
      - /mnt/remotes/192.168.1.5_video:/mnt/remotes/192.168.1.5_video:ro

    environment:
      - TZ=America/New_York  # Adjust to your timezone
    # Optional: limit CPU for background scanning
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
    networks:
      - media-network

networks:
  media-network:
    external: true  # Use existing network with Radarr/Sonarr
    # Or create a new one:
    # driver: bridge
