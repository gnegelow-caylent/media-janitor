# Media Janitor Configuration
# Copy this to config.yaml and fill in your values

# =============================================================================
# Radarr Instances (Movies)
# =============================================================================
radarr:
  - name: "radarr"
    url: "http://YOUR_SERVER_IP:7878"
    api_key: "YOUR_RADARR_API_KEY"
    # Path mappings translate Radarr's container paths to actual filesystem paths
    # Find your root folders in Radarr -> Settings -> Media Management
    path_mappings:
      - from_path: "/movies"          # Path as Radarr sees it
        to_path: "/media/movies"      # Path as media-janitor sees it

# =============================================================================
# Sonarr Instances (TV Shows)
# =============================================================================
sonarr:
  - name: "sonarr"
    url: "http://YOUR_SERVER_IP:8989"
    api_key: "YOUR_SONARR_API_KEY"
    path_mappings:
      - from_path: "/tv"              # Path as Sonarr sees it
        to_path: "/media/tv"          # Path as media-janitor sees it

# =============================================================================
# Plex Integration (Optional)
# =============================================================================
# You can also login via OAuth in the Web UI instead of setting token here
plex:
  enabled: false
  url: "http://YOUR_SERVER_IP:32400"
  token: ""  # Optional - you can login via Web UI instead
  refresh_on_replace: true

# =============================================================================
# Validation Settings
# =============================================================================
validation:
  # Duration sanity check - flag files with unrealistic durations
  check_duration_sanity: true
  max_duration_hours: 12

  # Bitrate checks - flag suspiciously low bitrates
  check_bitrate: true
  min_bitrate_720p: 1500   # kbps
  min_bitrate_1080p: 3000  # kbps
  min_bitrate_4k: 8000     # kbps

  # Deep scan - decode samples from start/middle/end of file
  # This catches corruption that metadata checks miss
  deep_scan_enabled: true

  # How many seconds to decode from each sample point (start/middle/end)
  # RECOMMENDED VALUES:
  #   Local SSD/NVMe:    30 (thorough)
  #   Local HDD:         15-20
  #   Network mounts:    5-10 (faster, reduces timeouts)
  sample_duration_seconds: 10

  # Timeout for each decode test
  # RECOMMENDED VALUES:
  #   Local storage:     60
  #   Network mounts:    30 (fails faster on slow connections)
  #   Unreliable network: 15
  decode_timeout_seconds: 30

  # Full decode - decode entire file (VERY slow, use sparingly)
  full_decode_enabled: false

# =============================================================================
# Background Scanner
# =============================================================================
scanner:
  enabled: true

  # How many files to scan per hour
  # Each file reads ~2-5MB for validation (headers + sample decode)
  # 300 = ~7200/day, ~1 day for 5000 movies
  # 600 = ~14400/day, ~8 hours for 5000 movies
  files_per_hour: 600

  # Number of files to validate in parallel
  # Higher = faster but more CPU/memory usage
  # RECOMMENDED VALUES:
  #   Powerful server:      10-20
  #   NAS/Low-power:        3-5
  #   Network mounts:       5-10 (limited by network, not CPU)
  concurrency: 10

  # Scan mode:
  # "watch_only" = scan library once, then only validate new imports via webhooks
  # "continuous" = keep re-scanning library forever
  mode: "watch_only"

  # When to refresh TV library (cron format)
  # TV loads on this schedule, movies load on startup
  # Set to null to disable automatic TV refresh
  tv_refresh_schedule: "0 3 * * *"  # 3am daily

# =============================================================================
# Auto-Replace Actions
# =============================================================================
actions:
  # Automatically delete bad files and trigger re-download
  auto_replace: true

  # Add bad releases to blocklist so they won't be re-downloaded
  blocklist_bad_releases: true

  # Maximum replacements per day (prevents hammering indexers)
  max_replacements_per_day: 10

  # Dry run mode - report only, don't actually delete/replace
  dry_run: false

# =============================================================================
# Notifications (Optional)
# =============================================================================
# Uncomment and configure the services you want to use

# notifications:
#   discord:
#     enabled: true
#     webhook_url: "https://discord.com/api/webhooks/..."
#
#   slack:
#     enabled: true
#     webhook_url: "https://hooks.slack.com/services/..."
#
#   telegram:
#     enabled: true
#     bot_token: "123456:ABC-DEF..."
#     chat_id: "-1001234567890"
#
#   pushover:
#     enabled: true
#     user_key: "your_user_key"
#     api_token: "your_api_token"
#
#   gotify:
#     enabled: true
#     server_url: "https://gotify.example.com"
#     app_token: "your_app_token"

# =============================================================================
# Email Notifications (Optional)
# =============================================================================
email:
  enabled: false
  smtp_host: "smtp.gmail.com"
  smtp_port: 587
  smtp_user: "you@gmail.com"
  smtp_password: "xxxx xxxx xxxx xxxx"  # Gmail App Password (not regular password)
  from_address: "you@gmail.com"
  to_address: "you@gmail.com"

  # When to send daily summary (24h format)
  daily_summary_time: "08:00"

# =============================================================================
# Webhook Server
# =============================================================================
webhook:
  enabled: true
  host: "0.0.0.0"
  port: 9000

# =============================================================================
# Logging
# =============================================================================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  file: "/data/logs/media-janitor.log"
